diff --git a/common/homedir.c b/common/homedir.c
index e1615e5..e0111f9 100644
--- a/common/homedir.c
+++ b/common/homedir.c
@@ -35,7 +35,9 @@
 #include <errno.h>
 #include <fcntl.h>
 #include <unistd.h>
-
+#ifdef __MVS__
+#include <zos.h>
+#endif
 #ifdef HAVE_W32_SYSTEM
 #include <winsock2.h>   /* Due to the stupid mingw64 requirement to
                            include this header before windows.h which
@@ -135,6 +137,48 @@ static byte w32_bin_is_bin;
 static const char *w32_rootdir (void);
 #endif
 
+#ifdef __MVS__
+const char* gnupg_get_install_dir(void)
+{
+    char* program_path= __getprogramdir();
+    if (program_path != NULL) {
+            char *last_slash = strrchr(program_path, '/');  // Find the last '/'
+            if (last_slash && strcmp(last_slash, "/bin") == 0) {
+            *last_slash = '\0';  // Truncate the string before '/bin'
+            }
+            return program_path;  // Return the modified program path
+    }
+    else
+    {
+            return NULL;
+    }
+}
+
+const char* get_pinentry_path(void) {
+    const char* suffix = "/../../../pinentry/pinentry/bin";
+    const char* bindir = gnupg_bindir();  // This function must be defined elsewhere
+
+    // Allocate memory dynamically for the new path
+    size_t new_path_length = strlen(bindir) + strlen(suffix) + 1; // +1 for null terminator
+    char* new_path = (char*)malloc(new_path_length);
+
+    if (new_path == NULL) {
+        fprintf(stderr, "Memory allocation failed\n");
+        return NULL;  // Return NULL if memory allocation fails
+    }
+
+    // Concatenate the strings
+    snprintf(new_path, new_path_length, "%s%s", bindir, suffix);
+
+    char* dir_name = xstrconcat(new_path, DIRSEP_S "pinentry", NULL);
+    gpgrt_annotate_leaked_object(dir_name);
+    free(new_path);
+
+    // Return the final path
+    return dir_name;
+}
+#endif
+
 /* Return the name of the gnupg dir.  This is usually "gnupg".  */
 static const char *
 my_gnupg_dirname (void)
@@ -843,6 +887,63 @@ w32_rootdir (void)
 
 
 #ifndef HAVE_W32_SYSTEM /* Unix */
+
+//__MVS__
+//
+#define _OPEN_SYS
+#include <stdio.h>
+#include <sys/ps.h>
+#include <sys/types.h>
+#include <pwd.h>
+#include <time.h>
+#include <string.h>
+#include <limits.h>
+#include <errno.h>
+
+char *readProcessPath()
+{
+ int token;
+  W_PSPROC buf;
+  struct passwd *pw;
+ char *parent;
+ parent = malloc(PATH_MAX);
+ memset( parent, 0, PATH_MAX);
+  token = 0;
+
+  memset(&buf, 0x00, sizeof(buf));
+  buf.ps_pathptr   = (char *) malloc(buf.ps_pathlen   = PS_PATHBLEN);
+  if (buf.ps_pathptr   == NULL)
+    perror("buffer allocation error");
+  else do {
+    if ((token = w_getpsent(token, &buf, sizeof(buf))) == -1)
+      perror("w_getpsent() error");
+    else if (token > 0)
+    {
+      if ((pw = getpwuid(buf.ps_ruid)) == NULL)
+        perror("getpwuid() error");
+      else
+      {
+         pid_t mypid = getpid();
+         if (buf.ps_pid == mypid)
+         {
+            char *res = realpath(buf.ps_pathptr, parent);
+            if (res)
+            {
+                return parent;
+            }
+            else {
+                perror("realpath() error");
+           }
+           break;
+         }
+      }
+    }
+  } while (token > 0);
+
+  return "";
+}
+
+
 /* Determine the root directory of the gnupg installation on Unix.
  * The standard case is that this function returns NULL so that the
  * root directory as configured at build time is used.  However, it
@@ -1489,6 +1590,7 @@ gnupg_socketdir (void)
 const char *
 gnupg_sysconfdir (void)
 {
+  char *dir;
 #ifdef HAVE_W32_SYSTEM
   static char *name;
 
@@ -1500,9 +1602,20 @@ gnupg_sysconfdir (void)
     }
   return name;
 #else /*!HAVE_W32_SYSTEM*/
-  const char *dir = unix_rootdir (WANTDIR_SYSCONF);
+ #if defined __MVS__
+  dir = gnupg_get_install_dir();
+  if (dir)
+  {
+        char *name = xstrconcat (dir, DIRSEP_S "etc", DIRSEP_S,
+                           my_gnupg_dirname (), NULL);
+        gpgrt_annotate_leaked_object (name);
+        return name;
+   }
+ #else /*!HAVE_W32_SYSTEM*/
+  dir = unix_rootdir (WANTDIR_SYSCONF); 
   if (dir)
     return dir;
+ #endif
   else
     return GNUPG_SYSCONFDIR;
 #endif /*!HAVE_W32_SYSTEM*/
@@ -1529,7 +1642,11 @@ gnupg_bindir (void)
   else
     return rdir;
 #else /*!HAVE_W32_SYSTEM*/
-  rdir = unix_rootdir (WANTDIR_ROOT);
+  #if defined __MVS__
+    rdir = gnupg_get_install_dir();
+  #else /*!HAVE_W32_SYSTEM*/
+    rdir = unix_rootdir (WANTDIR_ROOT);
+  #endif
   if (rdir)
     {
       if (!name)
@@ -1556,7 +1673,11 @@ gnupg_libexecdir (void)
   static char *name;
   const char *rdir;
 
-  rdir = unix_rootdir (WANTDIR_ROOT);
+#ifdef __MVS__
+   rdir = gnupg_get_install_dir();
+#else
+   rdir = unix_rootdir (WANTDIR_ROOT);
+#endif
   if (rdir)
     {
       if (!name)
@@ -1586,7 +1707,11 @@ gnupg_libdir (void)
 #else /*!HAVE_W32_SYSTEM*/
   const char *rdir;
 
-  rdir = unix_rootdir (WANTDIR_ROOT);
+ #ifdef __MVS__
+   rdir = gnupg_get_install_dir();
+ #else
+   rdir = unix_rootdir (WANTDIR_ROOT);
+ #endif
   if (rdir)
     {
       if (!name)
@@ -1617,7 +1742,11 @@ gnupg_datadir (void)
 #else /*!HAVE_W32_SYSTEM*/
   const char *rdir;
 
-  rdir = unix_rootdir (WANTDIR_ROOT);
+ #ifdef __MVS__
+    rdir = gnupg_get_install_dir();
+ #else
+    rdir = unix_rootdir (WANTDIR_ROOT);
+ #endif
   if (rdir)
     {
       if (!name)
@@ -1649,7 +1778,11 @@ gnupg_localedir (void)
 #else /*!HAVE_W32_SYSTEM*/
   const char *rdir;
 
-  rdir = unix_rootdir (WANTDIR_ROOT);
+ #ifdef __MVS__
+    rdir = gnupg_get_install_dir();
+ #else
+    rdir = unix_rootdir (WANTDIR_ROOT);
+ #endif
   if (rdir)
     {
       if (!name)
@@ -1806,6 +1939,9 @@ gnupg_set_builddir (const char *newdir)
 static void
 gnupg_set_builddir_from_env (void)
 {
+#ifdef __MVS__
+  gnupg_build_directory = gnupg_get_install_dir(); 
+#endif
 #if defined(IS_DEVELOPMENT_VERSION) || defined(ENABLE_GNUPG_BUILDDIR_ENVVAR)
   if (gnupg_build_directory)
     return;
@@ -1822,7 +1958,9 @@ gnupg_module_name (int which)
 {
   gnupg_set_builddir_from_env ();
   gnupg_module_name_called = 1;
-
+#ifdef __MVS__
+  static char *dir_name;
+#endif
 #define X(a,b,c) do {                                                   \
     static char *name;                                                  \
     if (!name) {                                                        \
@@ -1840,6 +1978,8 @@ gnupg_module_name (int which)
     case GNUPG_MODULE_NAME_AGENT:
 #ifdef GNUPG_DEFAULT_AGENT
       return GNUPG_DEFAULT_AGENT;
+#elif defined (__MVS__)
+      X(bindir, "bin", "gpg-agent");
 #else
       X(bindir, "agent", "gpg-agent");
 #endif
@@ -1847,6 +1987,15 @@ gnupg_module_name (int which)
     case GNUPG_MODULE_NAME_PINENTRY:
 #ifdef GNUPG_DEFAULT_PINENTRY
       return GNUPG_DEFAULT_PINENTRY;  /* (Set by a configure option) */
+#elif defined (__MVS__) 
+    {
+      dir_name = get_pinentry_path();
+      if (dir_name != NULL) {
+       return dir_name;
+     }
+     else
+      return NULL;
+    }
 #else
       return get_default_pinentry_name (0);
 #endif
@@ -1868,6 +2017,8 @@ gnupg_module_name (int which)
     case GNUPG_MODULE_NAME_DIRMNGR:
 #ifdef GNUPG_DEFAULT_DIRMNGR
       return GNUPG_DEFAULT_DIRMNGR;
+#elif defined (__MVS__)
+      X(bindir, "bin", DIRMNGR_NAME);
 #else
       X(bindir, "dirmngr", DIRMNGR_NAME);
 #endif
@@ -1897,25 +2048,53 @@ gnupg_module_name (int which)
       X(libexecdir, "tools", "gpg-check-pattern");
 
     case GNUPG_MODULE_NAME_GPGSM:
-      X(bindir, "sm", "gpgsm");
+#ifdef __MVS__
+       X(bindir, "bin", "gpgsm");
+#else
+       X(bindir, "sm", "gpgsm");
+#endif
 
     case GNUPG_MODULE_NAME_GPG:
-      X(bindir, "g10", GPG_NAME);
+#ifdef __MVS__
+       X(bindir, "bin", GPG_NAME);
+#else
+       X(bindir, "g10", GPG_NAME);
+#endif
 
     case GNUPG_MODULE_NAME_GPGV:
+#ifdef __MVS__
+      X(bindir, "bin", GPG_NAME);
+#else
       X(bindir, "g10", GPG_NAME "v");
+#endif
 
     case GNUPG_MODULE_NAME_CONNECT_AGENT:
-      X(bindir, "tools", "gpg-connect-agent");
+#if __MVS__
+       X(bindir, "bin", "gpg-connect-agent");
+#else
+       X(bindir, "tools", "gpg-connect-agent");
+#endif
 
     case GNUPG_MODULE_NAME_GPGCONF:
-      X(bindir, "tools", "gpgconf");
+#if __MVS__
+       X(bindir, "bin", "gpgconf");
+#else
+       X(bindir, "tools", "gpgconf");
+#endif
 
     case GNUPG_MODULE_NAME_CARD:
-      X(bindir, "tools", "gpg-card");
+#if __MVS__
+       X(bindir, "bin", "gpg-card");
+#else
+       X(bindir, "tools", "gpg-card");
+#endif
 
     case GNUPG_MODULE_NAME_GPGTAR:
+#if __MVS__
+        X(bindir, "bin", "gpgtar");
+#else
       X(bindir, "tools", "gpgtar");
+#endif
 
     default:
       BUG ();
